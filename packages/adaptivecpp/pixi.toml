# naga-adaptivecpp-toolkit Workspace
# AdaptiveCpp SYCL compiler with NVIDIA CUDA support
#
# ============================================================================
# WORKFLOW
# ============================================================================
#
# First time setup (creates recipe symlinks):
#   pixi run -e acpp-init setup
#
# Build and install:
#   pixi install
#
# This builds three packages from one recipe:
#   - naga-adaptivecpp-toolkit-libs:  Runtime libraries only (libacpp-rt.so, etc.)
#   - naga-adaptivecpp-toolkit-devel: Development files (headers, cmake modules)
#   - naga-adaptivecpp-toolkit:       Full toolkit with compiler and tools
#
# ============================================================================
# BUILD STRATEGY
# ============================================================================
#
# The build runs directly in the repo/ directory (not a copy) to enable
# incremental builds. Subsequent builds only recompile changed files.
# A full initial build takes ~15-30 minutes; incremental builds are much faster.
#
# ============================================================================

[workspace]
channels = ["https://prefix.dev/pixi-build-backends", "conda-forge"]
platforms = ["linux-64"]
preview = ["pixi-build"]


[package.build]
backend = { name = "pixi-build-rattler-build", version = "*" }


[package.build.config]
experimental = false

[system-requirements]
libc = "2.34"

[target.linux-64.dependencies]
# naga-adaptivecpp-toolkit = { path = "." }
sysroot_linux-64 = ">=2.34"

[dependencies]
naga-adaptivecpp-toolkit-libs = { url = "file:///home/jack/sycl-build-project/CodeAccelerate-SYCLBuildKit/packages/adaptivecpp/naga-adaptivecpp-toolkit-libs-2026.2.17-h9f6055b_0.conda" }
naga-adaptivecpp-toolkit = { url = "file:///home/jack/sycl-build-project/CodeAccelerate-SYCLBuildKit/packages/adaptivecpp/naga-adaptivecpp-toolkit-2026.2.17-h9f6055b_0.conda" }
naga-adaptivecpp-toolkit-devel = { url = "file:///home/jack/sycl-build-project/CodeAccelerate-SYCLBuildKit/packages/adaptivecpp/naga-adaptivecpp-toolkit-devel-2026.2.17-h9f6055b_0.conda" }

[tasks]
repos-init = { cmd = "nu scripts/init-repos.nu", description = "Initialize git repositories from .repos.toml" }
